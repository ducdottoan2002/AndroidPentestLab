# AndroidPentestLab
Doing lab 4 WEB AND APPLICATION SECURITY COURSE

## **1. Introduce**
<p align=center>Pengu is learning how to crack an android app!!

## **2. Tools**
* ByteCode-Viewer 2.11.2
* apktool
* frida-server
* Xposed Framework
* ...


## **3. Writeup for lab**
### **3.1. challenge2_release.apk**
Reverse and crack the app to get pin/flag
<p align="center">
  <img src="FridaLab/FindPin.png" height="40%" width="40%">
</p>

#### **a. Reversing the apk:**
<p align="center">
  <img src="FridaLab/MainActivityClass.png" height="75%" width="75%">
</p>

* The variable cipherText is assigned the value of Hex().decode() of a hexadecimal string.
* After input 6-length pin, the PIN is passed into the native function `getKey(string)`:
<p align="center">
  <img src="FridaLab/PinLock.png" height="75%" width="75%">
</p>

#### **b. Hooking by Frida**
* We can use Frida to hook this native function and brute-force to get cipherText but the `getKey(string)` function only allows 51 attempts for input.

  Therefore, you need to combine it with the resetCooldown function in the native library to reset the count to 0 when it reaches 50.

* The script could only brute-force about 16,000 PINs before it crashed, so I had to run it several times :(((
  
  Run [script.js](Fridalab/script.js) by this command:
  ```frida -U com.hackerone.mobile.challenge2 -l script.js```
  
  And the correct pin we got was `918264`
<p align="center">
  <img src="FridaLab\CorrectPin.png" height="75%" width="75%">
</p>


### **3.2. Activity Exploiting**
* Create project:
<p align="center">
  <img src="image\createExploitApp.png" height="75%" width="75%">
</p>

* Code Exploitation:
<p align="center">
  <img src="image\ExploitationCode.png" height="75%" width="75%">
</p>


### **3.3. BroadcastReceiver Exploiting**
Exploiting the exported receiver of InsecureBankv2 app:
<p align="center">
  <img src="image\ExportedReceiver.png" height="75%" width="75%">
</p>
We will exploit this BroadcastReceiver, and when someone installs and opens the app, it will automatically send a pre-defined message to the specified phone number.

* Full Exploitation Code:
<p align="center">
  <img src="image\CodeExploitReceiver.png" height="75%" width="75%">
</p>

* Demo:

It will only automatically send the message when i have just been INSTALLED.
<p align="center">
  <img src="image\ExploitedReceiver.png" height="75%" width="75%">
</p>